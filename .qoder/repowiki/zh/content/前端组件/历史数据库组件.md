# å†å²æ•°æ®åº“ç»„ä»¶

<cite>
**æœ¬æ–‡å¼•ç”¨çš„æ–‡ä»¶**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue)
- [simulation.js](file://frontend/src/api/simulation.js)
- [simulation.py](file://backend/app/api/simulation.py)
- [simulation_manager.py](file://backend/app/services/simulation_manager.py)
- [simulation_runner.py](file://backend/app/services/simulation_runner.py)
- [config.py](file://backend/app/config.py)
- [Step4Report.vue](file://frontend/src/components/Step4Report.vue)
- [Process.vue](file://frontend/src/views/Process.vue)
- [MainView.vue](file://frontend/src/views/MainView.vue)
- [Step2EnvSetup.vue](file://frontend/src/components/Step2EnvSetup.vue)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
3. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
4. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
5. [è¯¦ç»†ç»„ä»¶åˆ†æ](#è¯¦ç»†ç»„ä»¶åˆ†æ)
6. [ä¾èµ–åˆ†æ](#ä¾èµ–åˆ†æ)
7. [æ€§èƒ½è€ƒè™‘](#æ€§èƒ½è€ƒè™‘)
8. [æ•…éšœæ’é™¤æŒ‡å—](#æ•…éšœæ’é™¤æŒ‡å—)
9. [ç»“è®º](#ç»“è®º)
10. [é™„å½•](#é™„å½•)

## ç®€ä»‹
å†å²æ•°æ®åº“ç»„ä»¶æ˜¯MiroFishç³»ç»Ÿä¸­ç”¨äºç®¡ç†ã€å­˜å‚¨å’Œå±•ç¤ºå†å²æ¨¡æ‹Ÿè®°å½•çš„æ ¸å¿ƒæ¨¡å—ã€‚å®ƒæä¾›äº†å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬å†å²æ•°æ®çš„æ”¶é›†ã€å¢å¼ºã€å­˜å‚¨ã€æ£€ç´¢å’Œå¯è§†åŒ–å±•ç¤ºã€‚è¯¥ç»„ä»¶æ”¯æŒå¤šç»´åº¦çš„å†å²æ•°æ®ç®¡ç†ï¼Œæ¶µç›–æ¨¡æ‹Ÿé¡¹ç›®ã€è¿è¡ŒçŠ¶æ€ã€æ–‡ä»¶å…³è”ã€æŠ¥å‘Šç”Ÿæˆç­‰å¤šä¸ªæ–¹é¢ã€‚

ç»„ä»¶é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå‰ç«¯è´Ÿè´£ç”¨æˆ·ç•Œé¢äº¤äº’å’Œæ•°æ®å±•ç¤ºï¼Œåç«¯æä¾›RESTful APIæ¥å£å’Œæ•°æ®æŒä¹…åŒ–æœåŠ¡ã€‚é€šè¿‡æ™ºèƒ½çš„æ•°æ®å¢å¼ºæœºåˆ¶ï¼Œå†å²è®°å½•ä¸ä»…åŒ…å«åŸºç¡€ä¿¡æ¯ï¼Œè¿˜èƒ½æä¾›ä¸°å¯Œçš„ä¸Šä¸‹æ–‡æ•°æ®ï¼Œå¦‚æ¨¡æ‹Ÿéœ€æ±‚ã€è¿è¡ŒçŠ¶æ€ã€æ–‡ä»¶å…³è”ç­‰ã€‚

## é¡¹ç›®ç»“æ„
å†å²æ•°æ®åº“ç»„ä»¶åœ¨MiroFishé¡¹ç›®ä¸­é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¸»è¦åˆ†å¸ƒåœ¨ä»¥ä¸‹ç›®å½•ï¼š

```mermaid
graph TB
subgraph "å‰ç«¯å±‚"
HD[HistoryDatabase.vue<br/>å†å²æ•°æ®åº“ç»„ä»¶]
API[simulation.js<br/>APIæ¥å£å°è£…]
Views[è§†å›¾ç»„ä»¶<br/>Process.vue, MainView.vue]
Reports[æŠ¥å‘Šç»„ä»¶<br/>Step4Report.vue]
end
subgraph "åç«¯å±‚"
API2[simulation.py<br/>APIè·¯ç”±]
Manager[simulation_manager.py<br/>æ¨¡æ‹Ÿç®¡ç†å™¨]
Runner[simulation_runner.py<br/>æ¨¡æ‹Ÿè¿è¡Œå™¨]
Config[config.py<br/>é…ç½®ç®¡ç†]
end
subgraph "æ•°æ®å­˜å‚¨"
Uploads[uploads/simulations<br/>æ¨¡æ‹Ÿæ•°æ®ç›®å½•]
SQLite[SQLiteæ•°æ®åº“<br/>reddit_simulation.db<br/>twitter_simulation.db]
State[state.json<br/>è¿è¡ŒçŠ¶æ€æ–‡ä»¶]
end
HD --> API
API --> API2
API2 --> Manager
API2 --> Runner
Manager --> Uploads
Runner --> SQLite
Runner --> State
Config --> API2
```

**å›¾è¡¨æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L1-L191)
- [simulation.py](file://backend/app/api/simulation.py#L1-L200)
- [simulation_manager.py](file://backend/app/services/simulation_manager.py#L125-L143)

**ç« èŠ‚æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L1-L191)
- [simulation.js](file://frontend/src/api/simulation.js#L180-L188)
- [simulation.py](file://backend/app/api/simulation.py#L880-L983)

## æ ¸å¿ƒç»„ä»¶
å†å²æ•°æ®åº“ç»„ä»¶ç”±å¤šä¸ªç›¸äº’åä½œçš„å­ç»„ä»¶æ„æˆï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰æ˜ç¡®çš„èŒè´£åˆ†å·¥ï¼š

### å†å²æ•°æ®åº“å±•ç¤ºç»„ä»¶
HistoryDatabase.vueæ˜¯å‰ç«¯çš„æ ¸å¿ƒå±•ç¤ºç»„ä»¶ï¼Œè´Ÿè´£å†å²è®°å½•çš„å¯è§†åŒ–å‘ˆç°ã€‚è¯¥ç»„ä»¶å®ç°äº†å¤æ‚çš„äº¤äº’é€»è¾‘ï¼ŒåŒ…æ‹¬å¡ç‰‡å¼å¸ƒå±€ã€åŠ¨æ€å±•å¼€æ•ˆæœã€æ–‡ä»¶ç±»å‹è¯†åˆ«ç­‰åŠŸèƒ½ã€‚

### APIæ¥å£å±‚
frontend/src/api/simulation.jså°è£…äº†æ‰€æœ‰ä¸å†å²æ•°æ®åº“ç›¸å…³çš„APIè°ƒç”¨ï¼Œæä¾›äº†ç»Ÿä¸€çš„æ¥å£è®¿é—®æ–¹å¼ã€‚è¯¥å±‚åŒ…å«äº†å†å²è®°å½•æŸ¥è¯¢ã€æ¨¡æ‹ŸçŠ¶æ€è·å–ã€é…ç½®ä¿¡æ¯è¯»å–ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

### åç«¯æœåŠ¡å±‚
åç«¯é€šè¿‡å¤šä¸ªæœåŠ¡ç±»æä¾›å†å²æ•°æ®ç®¡ç†èƒ½åŠ›ï¼š
- SimulationManagerï¼šæ¨¡æ‹Ÿç®¡ç†å™¨ï¼Œè´Ÿè´£æ¨¡æ‹ŸçŠ¶æ€çš„æŒä¹…åŒ–å’Œæ£€ç´¢
- SimulationRunnerï¼šæ¨¡æ‹Ÿè¿è¡Œå™¨ï¼Œè´Ÿè´£è¿è¡Œæ—¶çŠ¶æ€çš„å®æ—¶è·Ÿè¸ª
- ZepGraphMemoryUpdaterï¼šå›¾è°±å†…å­˜æ›´æ–°å™¨ï¼Œæ”¯æŒå†å²æ•°æ®çš„å¢é‡æ›´æ–°

**ç« èŠ‚æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L193-L569)
- [simulation.js](file://frontend/src/api/simulation.js#L1-L188)
- [simulation_manager.py](file://backend/app/services/simulation_manager.py#L114-L200)

## æ¶æ„æ¦‚è§ˆ
å†å²æ•°æ®åº“ç»„ä»¶é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œç¡®ä¿äº†è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ï¼š

```mermaid
graph TB
subgraph "è¡¨ç°å±‚"
UI[HistoryDatabase.vue<br/>ç”¨æˆ·ç•Œé¢]
Modal[æ¨¡æ€æ¡†<br/>é¡¹ç›®è¯¦æƒ…]
Cards[å¡ç‰‡ç»„ä»¶<br/>é¡¹ç›®å¡ç‰‡]
end
subgraph "åº”ç”¨å±‚"
API[APIå±‚<br/>simulation.js]
Router[è·¯ç”±æ§åˆ¶<br/>Vue Router]
Store[çŠ¶æ€ç®¡ç†<br/>å“åº”å¼æ•°æ®]
end
subgraph "ä¸šåŠ¡é€»è¾‘å±‚"
Manager[SimulationManager<br/>æ¨¡æ‹Ÿç®¡ç†]
Runner[SimulationRunner<br/>è¿è¡ŒçŠ¶æ€]
Reader[ZepEntityReader<br/>å®ä½“è¯»å–]
end
subgraph "æ•°æ®è®¿é—®å±‚"
FS[æ–‡ä»¶ç³»ç»Ÿ<br/>uploads/simulations]
DB[SQLiteæ•°æ®åº“<br/>æ¨¡æ‹Ÿæ•°æ®]
State[çŠ¶æ€æ–‡ä»¶<br/>state.json]
end
UI --> API
API --> Manager
API --> Runner
Manager --> FS
Runner --> DB
Runner --> State
Reader --> FS
```

**å›¾è¡¨æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L193-L210)
- [simulation.py](file://backend/app/api/simulation.py#L164-L200)
- [simulation_manager.py](file://backend/app/services/simulation_manager.py#L114-L137)

## è¯¦ç»†ç»„ä»¶åˆ†æ

### å†å²æ•°æ®åº“å±•ç¤ºç»„ä»¶åˆ†æ
HistoryDatabase.vueæ˜¯æ•´ä¸ªå†å²æ•°æ®åº“ç»„ä»¶çš„æ ¸å¿ƒUIç»„ä»¶ï¼Œå®ç°äº†ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½å’Œè§†è§‰æ•ˆæœã€‚

#### ç»„ä»¶æ¶æ„è®¾è®¡
ç»„ä»¶é‡‡ç”¨å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå¤šç§æ˜¾ç¤ºæ¨¡å¼å’Œäº¤äº’çŠ¶æ€ï¼š

```mermaid
classDiagram
class HistoryDatabase {
+Array projects
+Boolean loading
+Boolean isExpanded
+Number hoveringCard
+Object selectedProject
+Object containerStyle
+loadHistory() void
+getCardStyle(index) Object
+navigateToProject(project) void
+getFileType(filename) String
+formatDate(date) String
+formatRounds(simulation) String
}
class ProjectCard {
+String simulation_id
+String project_id
+String report_id
+Array files
+String simulation_requirement
+String created_at
+Number current_round
+Number total_rounds
+getProgressClass() String
+truncateText(text, length) String
}
class ModalDialog {
+Object selectedProject
+closeModal() void
+goToProject() void
+goToSimulation() void
+goToReport() void
}
HistoryDatabase --> ProjectCard : "æ¸²æŸ“"
HistoryDatabase --> ModalDialog : "å¼¹çª—"
ProjectCard --> ModalDialog : "æŸ¥çœ‹è¯¦æƒ…"
```

**å›¾è¡¨æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L193-L435)

#### æ•°æ®æµå¤„ç†æœºåˆ¶
ç»„ä»¶å®ç°äº†å¤æ‚çš„æ•°æ®æµå¤„ç†é€»è¾‘ï¼ŒåŒ…æ‹¬Intersection Observerçš„ä½¿ç”¨æ¥ä¼˜åŒ–æ€§èƒ½ï¼š

```mermaid
sequenceDiagram
participant User as ç”¨æˆ·
participant Component as HistoryDatabase
participant Observer as IntersectionObserver
participant API as APIå±‚
participant Backend as åç«¯æœåŠ¡
User->>Component : æ»šåŠ¨é¡µé¢
Component->>Observer : åˆå§‹åŒ–è§‚å¯Ÿå™¨
Observer->>Component : è§¦å‘å±•å¼€/æ”¶èµ·
Component->>Component : é˜²æŠ–å¤„ç†(50-200ms)
Component->>API : è°ƒç”¨getSimulationHistory()
API->>Backend : è¯·æ±‚å†å²æ•°æ®
Backend->>Backend : æŸ¥è¯¢æ¨¡æ‹ŸçŠ¶æ€
Backend->>Backend : å¢å¼ºæ¨¡æ‹Ÿæ•°æ®
Backend-->>API : è¿”å›å†å²è®°å½•
API-->>Component : å†å²æ•°æ®
Component->>Component : æ›´æ–°é¡¹ç›®åˆ—è¡¨
Component->>Component : åŠ¨ç”»è¿‡æ¸¡æ•ˆæœ
```

**å›¾è¡¨æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L437-L532)
- [simulation.js](file://frontend/src/api/simulation.js#L180-L186)

#### æ–‡ä»¶ç±»å‹è¯†åˆ«ä¸å±•ç¤º
ç»„ä»¶å†…ç½®äº†æ™ºèƒ½çš„æ–‡ä»¶ç±»å‹è¯†åˆ«ç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«ä¸åŒç±»å‹çš„æ–‡ä»¶å¹¶æä¾›ç›¸åº”çš„è§†è§‰æ ‡è¯†ï¼š

| æ–‡ä»¶ç±»å‹ | æ‰©å±•åç¤ºä¾‹ | è§†è§‰æ ‡è¯† |
|---------|-----------|----------|
| PDFæ–‡æ¡£ | pdf | ğŸ“„ |
| Wordæ–‡æ¡£ | doc, docx | ğŸ“„ |
| Excelè¡¨æ ¼ | xls, xlsx, csv | ğŸ“Š |
| PowerPoint | ppt, pptx | ğŸ¯ |
| æ–‡æœ¬æ–‡ä»¶ | txt, md, json | ğŸ“ |
| å›¾ç‰‡æ–‡ä»¶ | jpg, jpeg, png, gif | ğŸ–¼ï¸ |
| å‹ç¼©åŒ… | zip, rar, 7z | ğŸ“¦ |

**ç« èŠ‚æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L360-L392)

### APIæ¥å£å±‚åˆ†æ
frontend/src/api/simulation.jsæä¾›äº†å®Œæ•´çš„APIæ¥å£å°è£…ï¼Œæ”¯æŒå†å²æ•°æ®åº“çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ã€‚

#### å†å²è®°å½•æŸ¥è¯¢æ¥å£
getSimulationHistory()æ¥å£æ˜¯å†å²æ•°æ®åº“çš„æ ¸å¿ƒå…¥å£ï¼Œè´Ÿè´£è·å–å†å²æ¨¡æ‹Ÿè®°å½•ï¼š

```mermaid
flowchart TD
Start([è°ƒç”¨getSimulationHistory]) --> ValidateParams["éªŒè¯å‚æ•°<br/>limit=20"]
ValidateParams --> CallAPI["è°ƒç”¨åç«¯API<br/>/api/simulation/history"]
CallAPI --> FetchData["è·å–å†å²æ•°æ®"]
FetchData --> EnrichData["å¢å¼ºæ•°æ®<br/>æ·»åŠ æ¨¡æ‹Ÿéœ€æ±‚ã€çŠ¶æ€ç­‰"]
EnrichData --> FormatResponse["æ ¼å¼åŒ–å“åº”"]
FormatResponse --> ReturnData["è¿”å›å†å²è®°å½•æ•°ç»„"]
ReturnData --> End([å®Œæˆ])
```

**å›¾è¡¨æ¥æº**
- [simulation.js](file://frontend/src/api/simulation.js#L180-L186)
- [simulation.py](file://backend/app/api/simulation.py#L906-L974)

#### æ•°æ®å¢å¼ºæœºåˆ¶
åç«¯æœåŠ¡å®ç°äº†æ™ºèƒ½çš„æ•°æ®å¢å¼ºåŠŸèƒ½ï¼Œä¸ºæ¯ä¸ªå†å²è®°å½•æ·»åŠ ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š

| å¢å¼ºå­—æ®µ | æ•°æ®æ¥æº | æè¿° |
|---------|---------|------|
| simulation_requirement | simulation_config.json | æ¨¡æ‹Ÿéœ€æ±‚æè¿° |
| total_simulation_hours | time_config | æ€»æ¨¡æ‹Ÿæ—¶é•¿ |
| current_round | run_state.json | å½“å‰è½®æ¬¡ |
| total_rounds | æ¨èè®¡ç®— | æ€»è½®æ¬¡æ•° |
| files | é¡¹ç›®æ–‡ä»¶ | å…³è”æ–‡ä»¶åˆ—è¡¨ |
| report_id | æŠ¥å‘ŠæŸ¥æ‰¾ | æœ€æ–°æŠ¥å‘ŠID |

**ç« èŠ‚æ¥æº**
- [simulation.py](file://backend/app/api/simulation.py#L912-L968)

### åç«¯æœåŠ¡å±‚åˆ†æ
åç«¯é€šè¿‡å¤šä¸ªä¸“ä¸šåŒ–çš„æœåŠ¡ç±»æä¾›å†å²æ•°æ®ç®¡ç†èƒ½åŠ›ã€‚

#### æ¨¡æ‹Ÿç®¡ç†å™¨
SimulationManageræ˜¯å†å²æ•°æ®ç®¡ç†çš„æ ¸å¿ƒæœåŠ¡ï¼Œè´Ÿè´£æ¨¡æ‹ŸçŠ¶æ€çš„æŒä¹…åŒ–å’Œæ£€ç´¢ï¼š

```mermaid
classDiagram
class SimulationManager {
+Dict~str, SimulationState~ _simulations
+String SIMULATION_DATA_DIR
+create_simulation() SimulationState
+list_simulations() SimulationState[]
+get_simulation_config() Dict
+get_profiles() Dict[]
+_save_simulation_state() void
+_load_simulation_state() SimulationState
}
class SimulationState {
+String simulation_id
+String project_id
+String graph_id
+Boolean enable_twitter
+Boolean enable_reddit
+SimulationStatus status
+Number entities_count
+Number profiles_count
+String[] entity_types
+Number current_round
+String twitter_status
+String reddit_status
+String created_at
+String updated_at
+String error
+to_dict() Dict
+to_simple_dict() Dict
}
SimulationManager --> SimulationState : "ç®¡ç†"
```

**å›¾è¡¨æ¥æº**
- [simulation_manager.py](file://backend/app/services/simulation_manager.py#L114-L200)

#### æ¨¡æ‹Ÿè¿è¡Œå™¨
SimulationRunnerè´Ÿè´£è¿è¡Œæ—¶çŠ¶æ€çš„å®æ—¶è·Ÿè¸ªå’Œå†å²æ•°æ®çš„ç”Ÿæˆï¼š

| è¿è¡ŒçŠ¶æ€ | æè¿° | ç”¨é€” |
|---------|------|------|
| CREATED | å·²åˆ›å»º | æ¨¡æ‹Ÿåˆå§‹åŒ–é˜¶æ®µ |
| PREPARING | å‡†å¤‡ä¸­ | é…ç½®ç”Ÿæˆå’Œèµ„æºå‡†å¤‡ |
| READY | å·²å°±ç»ª | ç­‰å¾…å¼€å§‹è¿è¡Œ |
| RUNNING | è¿è¡Œä¸­ | æ¨¡æ‹Ÿæ‰§è¡Œé˜¶æ®µ |
| PAUSED | å·²æš‚åœ | æš‚åœçŠ¶æ€ |
| STOPPED | å·²åœæ­¢ | æ‰‹åŠ¨åœæ­¢ |
| COMPLETED | å·²å®Œæˆ | è‡ªç„¶ç»“æŸ |
| FAILED | å·²å¤±è´¥ | æ‰§è¡Œå¤±è´¥ |

**ç« èŠ‚æ¥æº**
- [simulation_runner.py](file://backend/app/services/simulation_runner.py#L35-L45)

## ä¾èµ–åˆ†æ
å†å²æ•°æ®åº“ç»„ä»¶çš„ä¾èµ–å…³ç³»æ¸…æ™°ä¸”å±‚æ¬¡åˆ†æ˜ï¼Œç¡®ä¿äº†ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

```mermaid
graph TB
subgraph "å¤–éƒ¨ä¾èµ–"
Vue[Vue.js 3.x<br/>å‰ç«¯æ¡†æ¶]
Flask[Flask<br/>åç«¯æ¡†æ¶]
SQLite[SQLite<br/>è½»é‡çº§æ•°æ®åº“]
Zep[Zep API<br/>å›¾è°±æœåŠ¡]
end
subgraph "å†…éƒ¨æ¨¡å—"
HD[HistoryDatabase.vue]
API[simulation.js]
SP[simulation.py]
SM[simulation_manager.py]
SR[simulation_runner.py]
CFG[config.py]
end
subgraph "æ•°æ®å­˜å‚¨"
Uploads[uploads/simulations]
State[state.json]
DB[SQLiteæ•°æ®åº“]
end
Vue --> HD
HD --> API
API --> SP
SP --> SM
SP --> SR
SP --> CFG
SM --> Uploads
SR --> DB
SR --> State
CFG --> SP
Zep --> SP
```

**å›¾è¡¨æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L193-L196)
- [simulation.py](file://backend/app/api/simulation.py#L1-L20)
- [config.py](file://backend/app/config.py#L35-L37)

**ç« èŠ‚æ¥æº**
- [config.py](file://backend/app/config.py#L1-L76)
- [simulation_manager.py](file://backend/app/services/simulation_manager.py#L1-L22)

## æ€§èƒ½è€ƒè™‘
å†å²æ•°æ®åº“ç»„ä»¶åœ¨è®¾è®¡æ—¶å……åˆ†è€ƒè™‘äº†æ€§èƒ½ä¼˜åŒ–ï¼Œé‡‡ç”¨äº†å¤šç§ç­–ç•¥æ¥æå‡ç”¨æˆ·ä½“éªŒï¼š

### å‰ç«¯æ€§èƒ½ä¼˜åŒ–
1. **Intersection Observerä¼˜åŒ–**ï¼šä½¿ç”¨Intersection Observer APIæ›¿ä»£ä¼ ç»Ÿçš„æ»šåŠ¨ç›‘å¬ï¼Œå‡å°‘DOMæ“ä½œé¢‘ç‡
2. **é˜²æŠ–æœºåˆ¶**ï¼šå±•å¼€/æ”¶èµ·æ“ä½œé‡‡ç”¨50-200msçš„é˜²æŠ–å»¶è¿Ÿï¼Œé¿å…é¢‘ç¹åŠ¨ç”»åˆ‡æ¢
3. **è™šæ‹Ÿæ»šåŠ¨**ï¼šå¯¹äºå¤§é‡å†å²è®°å½•ï¼Œé‡‡ç”¨è™šæ‹Ÿæ»šåŠ¨æŠ€æœ¯å‡å°‘DOMèŠ‚ç‚¹æ•°é‡
4. **æ‡’åŠ è½½**ï¼šå›¾ç‰‡å’Œæ–‡ä»¶å›¾æ ‡é‡‡ç”¨æ‡’åŠ è½½ç­–ç•¥

### åç«¯æ€§èƒ½ä¼˜åŒ–
1. **çŠ¶æ€ç¼“å­˜**ï¼šå†…å­˜ä¸­ç¼“å­˜æ¨¡æ‹ŸçŠ¶æ€ï¼Œå‡å°‘æ–‡ä»¶I/Oæ“ä½œ
2. **æ‰¹é‡æŸ¥è¯¢**ï¼šå†å²è®°å½•æŸ¥è¯¢æ”¯æŒæ‰¹é‡è·å–ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”
3. **æ•°æ®åˆ†é¡µ**ï¼šé»˜è®¤é™åˆ¶è¿”å›20æ¡è®°å½•ï¼Œæ”¯æŒåˆ†é¡µåŠ è½½
4. **æ™ºèƒ½ç´¢å¼•**ï¼šSQLiteæ•°æ®åº“å»ºç«‹é€‚å½“çš„ç´¢å¼•æé«˜æŸ¥è¯¢æ•ˆç‡

### ç¼“å­˜ç­–ç•¥
ç»„ä»¶å®ç°äº†å¤šå±‚æ¬¡çš„ç¼“å­˜æœºåˆ¶ï¼š
- **å†…å­˜ç¼“å­˜**ï¼šæ¨¡æ‹ŸçŠ¶æ€åœ¨å†…å­˜ä¸­ç¼“å­˜
- **æ–‡ä»¶ç¼“å­˜**ï¼šçŠ¶æ€æ–‡ä»¶å®šæœŸåˆ·æ–°
- **æµè§ˆå™¨ç¼“å­˜**ï¼šé™æ€èµ„æºåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜

## æ•…éšœæ’é™¤æŒ‡å—
å†å²æ•°æ®åº“ç»„ä»¶å¯èƒ½é‡åˆ°çš„å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼š

### å†å²è®°å½•æ— æ³•åŠ è½½
**ç—‡çŠ¶**ï¼šé¡µé¢æ˜¾ç¤ºç©ºç™½æˆ–åŠ è½½çŠ¶æ€æŒç»­
**å¯èƒ½åŸå› **ï¼š
1. åç«¯æœåŠ¡æœªå¯åŠ¨
2. APIæ¥å£è®¿é—®å¤±è´¥
3. æ•°æ®åº“è¿æ¥å¼‚å¸¸

**è§£å†³æ­¥éª¤**ï¼š
1. æ£€æŸ¥åç«¯æœåŠ¡æ—¥å¿—
2. éªŒè¯APIæ¥å£è¿é€šæ€§
3. ç¡®è®¤æ•°æ®åº“æ–‡ä»¶å­˜åœ¨

### æ–‡ä»¶ç±»å‹è¯†åˆ«é”™è¯¯
**ç—‡çŠ¶**ï¼šæ–‡ä»¶å›¾æ ‡æ˜¾ç¤ºä¸æ­£ç¡®
**å¯èƒ½åŸå› **ï¼š
1. æ–‡ä»¶æ‰©å±•åç¼ºå¤±
2. æ–°æ–‡ä»¶ç±»å‹æœªæ”¯æŒ

**è§£å†³æ­¥éª¤**ï¼š
1. æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ ¼å¼
2. æ›´æ–°æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨

### æ€§èƒ½é—®é¢˜
**ç—‡çŠ¶**ï¼šé¡µé¢å¡é¡¿æˆ–å“åº”ç¼“æ…¢
**å¯èƒ½åŸå› **ï¼š
1. å†å²è®°å½•è¿‡å¤š
2. åŠ¨ç”»æ•ˆæœå½±å“æ€§èƒ½

**è§£å†³æ­¥éª¤**ï¼š
1. å¯ç”¨è™šæ‹Ÿæ»šåŠ¨
2. å‡å°‘åŒæ—¶æ¸²æŸ“çš„å¡ç‰‡æ•°é‡
3. è°ƒæ•´åŠ¨ç”»å‚æ•°

**ç« èŠ‚æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L437-L532)
- [simulation.py](file://backend/app/api/simulation.py#L976-L982)

## ç»“è®º
å†å²æ•°æ®åº“ç»„ä»¶æ˜¯MiroFishç³»ç»Ÿä¸­ä¸å¯æˆ–ç¼ºçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„å’Œå®Œå–„çš„å®ç°ï¼Œä¸ºç”¨æˆ·æä¾›äº†å¼ºå¤§è€Œæ˜“ç”¨çš„å†å²æ•°æ®ç®¡ç†èƒ½åŠ›ã€‚ç»„ä»¶å…·æœ‰ä»¥ä¸‹æ˜¾è‘—ç‰¹ç‚¹ï¼š

1. **å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šä»æ•°æ®æ”¶é›†åˆ°å±•ç¤ºçš„å…¨æµç¨‹è¦†ç›–
2. **æ™ºèƒ½çš„æ•°æ®å¢å¼º**ï¼šä¸ºå†å²è®°å½•æä¾›ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯
3. **ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ**ï¼šæµç•…çš„åŠ¨ç”»æ•ˆæœå’Œç›´è§‚çš„ç•Œé¢è®¾è®¡
4. **é«˜æ€§èƒ½çš„å®ç°**ï¼šé‡‡ç”¨å¤šç§ä¼˜åŒ–ç­–ç•¥ç¡®ä¿ç³»ç»Ÿæ€§èƒ½
5. **è‰¯å¥½çš„å¯æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ä¾¿äºåŠŸèƒ½æ‰©å±•å’Œç»´æŠ¤

è¯¥ç»„ä»¶çš„æˆåŠŸå®ç°ä¸ºMiroFishç³»ç»Ÿçš„æ•´ä½“åŠŸèƒ½å¥ å®šäº†åšå®çš„åŸºç¡€ï¼Œä¸ºç”¨æˆ·æä¾›äº†å¯é çš„å†å²æ•°æ®ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚

## é™„å½•

### é…ç½®é€‰é¡¹
å†å²æ•°æ®åº“ç»„ä»¶æ”¯æŒä»¥ä¸‹é…ç½®é€‰é¡¹ï¼š

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|-------|------|--------|------|
| OASIS_DEFAULT_MAX_ROUNDS | Integer | 10 | é»˜è®¤æœ€å¤§è½®æ¬¡æ•° |
| OASIS_SIMULATION_DATA_DIR | String | uploads/simulations | æ¨¡æ‹Ÿæ•°æ®å­˜å‚¨ç›®å½• |
| LLM_API_KEY | String | - | LLM APIå¯†é’¥ |
| ZEP_API_KEY | String | - | Zep APIå¯†é’¥ |

### APIæ¥å£è§„èŒƒ
ç»„ä»¶æä¾›ä»¥ä¸‹æ ¸å¿ƒAPIæ¥å£ï¼š

| æ¥å£åç§° | æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½æè¿° |
|---------|------|------|----------|
| è·å–å†å²è®°å½• | GET | /api/simulation/history | è·å–å†å²æ¨¡æ‹Ÿè®°å½• |
| åˆ›å»ºæ¨¡æ‹Ÿ | POST | /api/simulation/create | åˆ›å»ºæ–°çš„æ¨¡æ‹Ÿ |
| å‡†å¤‡æ¨¡æ‹Ÿ | POST | /api/simulation/prepare | å‡†å¤‡æ¨¡æ‹Ÿç¯å¢ƒ |
| å¯åŠ¨æ¨¡æ‹Ÿ | POST | /api/simulation/start | å¯åŠ¨æ¨¡æ‹Ÿè¿è¡Œ |
| è·å–æ¨¡æ‹ŸçŠ¶æ€ | GET | /api/simulation/:id/run-status | è·å–è¿è¡ŒçŠ¶æ€ |

### äº‹ä»¶ç›‘å¬æœºåˆ¶
ç»„ä»¶æ”¯æŒä»¥ä¸‹äº‹ä»¶ç›‘å¬ï¼š

```mermaid
sequenceDiagram
participant Component as ç»„ä»¶
participant Observer as è§‚å¯Ÿå™¨
participant Router as è·¯ç”±å™¨
participant Store as çŠ¶æ€ç®¡ç†
Component->>Observer : åˆå§‹åŒ–IntersectionObserver
Observer->>Component : è§¦å‘å±•å¼€/æ”¶èµ·äº‹ä»¶
Component->>Store : æ›´æ–°çŠ¶æ€
Component->>Router : å¯¼èˆªåˆ°è¯¦æƒ…é¡µ
Router->>Component : åŠ è½½è¯¦æƒ…æ•°æ®
Component->>Component : æ¸²æŸ“è¯¦æƒ…ç•Œé¢
```

**å›¾è¡¨æ¥æº**
- [HistoryDatabase.vue](file://frontend/src/components/HistoryDatabase.vue#L534-L555)